---
scenario: >-
  You would like to find relevant articles by sorting the results and filtering
  by the organisation(s) that published the articles.


  Things to try:

  1. Sort the list of results so that the oldest results are first.

  2. Filter the list of results to show only those published by the Ministry of
     Defence.

notes: >-
  The filtering and sorting may not be accurate â€“ this is just a demonstration
  of the sort of interactions that you would find on a search page.

  This example merges features seen on GOV.UK news and communication finders and search pages.
---

{% extends "full-page-example.njk" %}

{% from "breadcrumbs/macro.njk" import govukBreadcrumbs %}
{% from "input/macro.njk" import govukInput %}
{% from "select/macro.njk" import govukSelect %}
{% from "checkboxes/macro.njk" import govukCheckboxes %}
{% from "button/macro.njk" import govukButton %}
{% from "pagination/macro.njk" import govukPagination %}

{% set pageTitle = "Search" %}
{% block pageTitle %}{{ pageTitle }} - GOV.UK{% endblock %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="/public/full-page-examples/search.css">
{% endblock %}

{% block beforeContent %}
    {{ govukBreadcrumbs({
        items: [
            {
                text: "Home",
                href: "#"
            }
        ]
    }) }}
{% endblock %}

{% block content %}
  <h1 class="moduk-heading-xl">{{ pageTitle }}</h1>

  {{ govukInput({
    label: {
      text: "Search GOV.UK",
      classes: "moduk-label--l, moduk-visually-hidden"
    },
    id: "search",
    name: "search",
    classes: "moduk-!-width-two-thirds",
    value: "driving"
  }) }}

  <div class="moduk-grid-row">
    <div class="moduk-grid-column-one-third">
      <ul class="moduk-list moduk-list--spaced app-filter">
        <li><a class="moduk-link" href="#">Topic</a></li>
        <li><a class="moduk-link" href="#">Content type</a></li>
        <li><a class="moduk-link" href="#">Updated</a></li>
      </ul>
      <form method="get" novalidate>
        {{ govukCheckboxes({
          idPrefix: "organisation",
          name: "organisation",
          classes: "moduk-checkboxes--small",
          fieldset: {
            legend: {
              html: "<a class='moduk-link' href=''>Organisation</a>",
              classes: "app-open-fieldset moduk-fieldset__legend--s"
            }
          },
          items: [
            {
              value: "hmrc",
              text: "HM Revenue and Customs (HMRC)",
              checked: values["organisation"]|length and "hmrc" in values["organisation"]
            },
            {
              value: "employment-tribunal",
              text: "Employment Tribunal",
              checked: values["organisation"]|length and "employment-tribunal" in values["organisation"]
            },
            {
              value: "mod",
              text: "Ministry of Defence",
              checked: values["organisation"]|length and "mod" in values["organisation"]
            }
          ]
        }) }}

        {{ govukButton({
            text: "Update filters"
        }) }}
      </form>
    </div>
    <div class="moduk-grid-column-two-thirds">
      <div class="app-search-results-summary">
        <h2 class="moduk-heading-s">{{ total }} results</h2>
        <span class="subscribe-link"><a href="#" class="moduk-link moduk-body-s">Subscribe to feed</a></span>
      </div>
      <hr class="moduk-section-break moduk-section-break--s moduk-section-break--visible moduk-!-margin-bottom-3">
      <div class="app-search-result-sort">
        {{ govukSelect({
          id: "sort",
          name: "sort",
          classes: "app-search-result-sort",
          label: {
            text: "Sort by"
          },
          items: [
            {
              value: "relevance",
              text: "Relevance"
            },
            {
              value: "updated-new",
              text: "Updated (newest)",
              selected: true
            },
            {
              value: "updated-old",
              text: "Updated (oldest)"
            }
          ]
        }) }}
      </div>
      <ul class="moduk-list app-document-list">
          {% for document in documents %}
              {% set document = document.document %}
              <li>
                  <h3 class="moduk-heading-s moduk-!-margin-bottom-2">
                    <a class="moduk-link moduk-link--no-underline" href="https://gov.uk{{ document.link }}">
                      {{ document.title }}
                    </a>
                  </h3>
                  <p class="moduk-body-s moduk-!-margin-bottom-4">
                      {{ document.summary }}
                  </p>
                  {% if document.children %}
                    <ul class="moduk-list app-search-result-list__children">
                      {% for child in document.children %}
                        <li>
                          <h4 class="moduk-heading-xs moduk-!-margin-bottom-1 moduk-!-margin-top-1">
                            <a class="moduk-link moduk-link--no-underline" href="#">
                              {{ child.title }}
                            </a>
                          </h4>
                          <p class="moduk-body-s">
                            {{ child.summary }}
                          </p>
                        </li>
                      {% endfor %}
                    </ul>
                  {% endif %}
                  {% if document.metadata %}
                    <ul class="app-metadata-list moduk-!-padding-0">
                        {% for data in document.metadata %}
                            <li class="moduk-body moduk-!-font-size-16">
                                {% if data['is_text'] %}
                                    {{ data.value }}
                                {% endif %}
                                {% if data['is_date'] %}
                                    Updated: {{ data['human_date'] }}
                                {% endif %}
                            </li>
                        {% endfor %}
                    </ul>
                  {% endif %}
              </li>
          {% endfor %}
      </ul>

      {{ govukPagination({
        next: {
          text: 'Next page',
          href: '#',
          labelText: '2 of 2939'
        }
      }) }}
    </div>
  </div>
{% endblock %}
